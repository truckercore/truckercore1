(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[31],{41640:function(e,t,n){Promise.resolve().then(n.bind(n,439))},99376:function(e,t,n){"use strict";var r=n(35475);n.o(r,"useParams")&&n.d(t,{useParams:function(){return r.useParams}}),n.o(r,"usePathname")&&n.d(t,{usePathname:function(){return r.usePathname}}),n.o(r,"useRouter")&&n.d(t,{useRouter:function(){return r.useRouter}}),n.o(r,"useSearchParams")&&n.d(t,{useSearchParams:function(){return r.useSearchParams}})},439:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return o}});var r=n(57437),s=n(2265),a=n(99376);function o(){let e=(0,a.useSearchParams)(),t=e.get("org"),n=e.get("role"),[o,i]=s.useState(null),[l,u]=s.useState(null),[c,d]=s.useState(null);s.useEffect(()=>{let e=e=>{e.preventDefault(),i(e)};return window.addEventListener("beforeinstallprompt",e),()=>window.removeEventListener("beforeinstallprompt",e)},[]);let p=()=>{let e=navigator,t=navigator.userAgent;return btoa([t,navigator.language,e.deviceMemory||"",e.hardwareConcurrency||""].join("|"))},f=async()=>{d(null);let e=await fetch("/api/issue-install-license",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({org_id:t,role:n,device_fingerprint:p()})}),r=await e.json();if(!e.ok){d((null==r?void 0:r.message)||"Failed to issue license");return}u(r.token);try{localStorage.setItem("offline_entitlement",JSON.stringify({token:r.token,org_id:t,role:n,exp:Date.now()+864e5}))}catch(e){}},h=async()=>{o?(o.prompt(),await o.userChoice,i(null)):alert("Use your browser's Install or Add to Desktop option.")};return(0,r.jsxs)("div",{style:{padding:24},children:[(0,r.jsx)("h1",{children:"Install"}),(0,r.jsx)("p",{children:"Install as a Desktop App for one-click access and offline support."}),(0,r.jsxs)("div",{style:{display:"flex",gap:12},children:[(0,r.jsx)("button",{onClick:h,children:"Install as Desktop App"}),(0,r.jsx)("a",{href:"https://www.pwabuilder.com",target:"_blank",rel:"noreferrer",children:"Optional: Download OS installer"})]}),(0,r.jsx)("h3",{style:{marginTop:16},children:"License"}),(0,r.jsx)("button",{onClick:f,children:"Issue device license"}),l&&(0,r.jsx)("div",{style:{wordBreak:"break-all",marginTop:8},children:"Issued"}),c&&(0,r.jsx)("div",{style:{color:"tomato"},children:c})]})}}},function(e){e.O(0,[2971,2117,1744],function(){return e(e.s=41640)}),_N_E=e.O()}]);