"use strict";(()=>{var e={};e.id=8631,e.ids=[8631],e.modules={13688:e=>{e.exports=require("@supabase/auth-js")},52513:e=>{e.exports=require("@supabase/functions-js")},41180:e=>{e.exports=require("@supabase/node-fetch")},19168:e=>{e.exports=require("@supabase/realtime-js")},10401:e=>{e.exports=require("@supabase/storage-js")},20145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},17811:e=>{e.exports=import("@supabase/postgrest-js")},37924:(e,s,r)=>{r.a(e,async(e,t)=>{try{r.r(s),r.d(s,{config:()=>c,default:()=>p,routeModule:()=>l});var a=r(71802),n=r(47153),o=r(56249),i=r(57333),u=e([i]);i=(u.then?(await u)():u)[0];let p=(0,o.l)(i,"default"),c=(0,o.l)(i,"config"),l=new a.PagesAPIRouteModule({definition:{kind:n.x.PAGES_API,page:"/api/paywall/nonce",pathname:"/api/paywall/nonce",bundlePath:"",filename:""},userland:i});t()}catch(e){t(e)}})},57333:(e,s,r)=>{r.a(e,async(e,t)=>{try{r.r(s),r.d(s,{default:()=>o});var a=r(85611),n=e([a]);async function o(e,s){if("POST"!==e.method)return s.status(405).end();try{let{user_id:r,org_id:t}=e.body||{};if(!r||!t)return s.status(400).json({error:"missing"});let{data:n,error:o}=await a.p.rpc("mint_paywall_nonce",{p_user:r,p_org:t,p_ttl_minutes:15});if(o)return s.status(500).json({error:o.message});let i=Array.isArray(n)?n[0]:n;return s.status(200).json({nonce:i?.nonce,expires_at:i?.expires_at})}catch(e){return s.status(500).json({error:e?.message||"server_error"})}}a=(n.then?(await n)():n)[0],t()}catch(e){t(e)}})},85611:(e,s,r)=>{r.a(e,async(e,t)=>{try{r.d(s,{p:()=>o});var a=r(4864),n=e([a]);a=(n.then?(await n)():n)[0];let o=(0,a.createClient)(process.env.SUPABASE_URL||"https://dummy.supabase.co",process.env.SUPABASE_SERVICE_ROLE_KEY||process.env.SUPABASE_SERVICE_ROLE||process.env.SUPABASE_SERVICE_KEY,{auth:{persistSession:!1}});t()}catch(e){t(e)}})}};var s=require("../../../webpack-api-runtime.js");s.C(e);var r=e=>s(s.s=e),t=s.X(0,[6791],()=>r(37924));module.exports=t})();