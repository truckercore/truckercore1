"use strict";(()=>{var e={};e.id=2149,e.ids=[2149,660],e.modules={1323:(e,t)=>{Object.defineProperty(t,"l",{enumerable:!0,get:function(){return function e(t,i){return i in t?t[i]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,i)):"function"==typeof t&&"default"===i?t:void 0}}})},52e3:(e,t,i)=>{i.r(t),i.d(t,{config:()=>m,default:()=>x,getServerSideProps:()=>S,getStaticPaths:()=>P,getStaticProps:()=>j,reportWebVitals:()=>y,routeModule:()=>O,unstable_getServerProps:()=>w,unstable_getServerSideProps:()=>A,unstable_getStaticParams:()=>v,unstable_getStaticPaths:()=>_,unstable_getStaticProps:()=>b});var n={};i.r(n),i.d(n,{default:()=>g});var r=i(87093),a=i(35244),l=i(1323),s=i(61682),o=i.n(s),d=i(48141),c=i.n(d),u=i(20997),h=i(16689),p=i.n(h);async function f(e,t){let i=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:t?JSON.stringify(t):void 0});if(!i.ok)throw Error(`${i.status} ${await i.text()}`);return i.json().catch(()=>({}))}function g(){let[e,t]=p().useState(""),[i,n]=p().useState([]),[r,a]=p().useState(null);async function l(){a(null);try{let t=await fetch(`/api/admin/coi-list?q=${encodeURIComponent(e)}&limit=50`);if(!t.ok)throw Error(await t.text());n(await t.json())}catch(e){a(String(e?.message||e))}}async function s(e,t){a(null);try{await f("/api/admin/coi-verify",{id:e,verified:t,note:t?"manual verify":"rejected"}),await l()}catch(e){a(String(e?.message||e))}}async function o(e){a(null);try{await f("/api/admin/billing-reconcile",{org_id:e}),alert("Reconcile triggered")}catch(e){a(String(e?.message||e))}}return(0,u.jsxs)("div",{style:{padding:20},children:[u.jsx("h2",{children:"Internal Ops"}),(0,u.jsxs)("section",{style:{marginBottom:24},children:[u.jsx("h3",{children:"COI Review"}),(0,u.jsxs)("div",{style:{display:"flex",gap:8},children:[u.jsx("input",{placeholder:"Search by org_id, file_key, user_id…",value:e,onChange:e=>t(e.target.value),style:{minWidth:380}}),u.jsx("button",{onClick:l,children:"Search"})]}),r&&u.jsx("pre",{style:{color:"crimson"},children:r}),(0,u.jsxs)("table",{style:{marginTop:12,width:"100%"},children:[u.jsx("thead",{children:(0,u.jsxs)("tr",{children:[u.jsx("th",{children:"ID"}),u.jsx("th",{children:"Org"}),u.jsx("th",{children:"User"}),u.jsx("th",{children:"File"}),u.jsx("th",{children:"Verified"}),u.jsx("th",{children:"Uploaded"}),u.jsx("th",{children:"Actions"})]})}),u.jsx("tbody",{children:i.map(e=>(0,u.jsxs)("tr",{children:[u.jsx("td",{children:e.id}),u.jsx("td",{children:e.org_id}),u.jsx("td",{children:e.user_id}),u.jsx("td",{children:u.jsx("a",{href:`/api/admin/coi-download?id=${encodeURIComponent(e.id)}`,target:"_blank",rel:"noreferrer",children:e.file_key})}),u.jsx("td",{children:String(e.verified)}),u.jsx("td",{children:new Date(e.uploaded_at).toLocaleString()}),(0,u.jsxs)("td",{style:{display:"flex",gap:8},children:[u.jsx("button",{onClick:()=>s(e.id,!0),children:"Verify"}),u.jsx("button",{onClick:()=>s(e.id,!1),children:"Reject"}),u.jsx("button",{onClick:()=>o(e.org_id),children:"Reconcile Subs"})]})]},e.id))})]})]}),(0,u.jsxs)("section",{children:[u.jsx("h3",{children:"Entitlements Viewer"}),u.jsx("p",{children:"Use COI search to fetch org_id, then “Reconcile Subs” to sync plan."})]})]})}let x=(0,l.l)(n,"default"),j=(0,l.l)(n,"getStaticProps"),P=(0,l.l)(n,"getStaticPaths"),S=(0,l.l)(n,"getServerSideProps"),m=(0,l.l)(n,"config"),y=(0,l.l)(n,"reportWebVitals"),b=(0,l.l)(n,"unstable_getStaticProps"),_=(0,l.l)(n,"unstable_getStaticPaths"),v=(0,l.l)(n,"unstable_getStaticParams"),w=(0,l.l)(n,"unstable_getServerProps"),A=(0,l.l)(n,"unstable_getServerSideProps"),O=new r.PagesRouteModule({definition:{kind:a.x.PAGES,page:"/admin/ops",pathname:"/admin/ops",bundlePath:"",filename:""},components:{App:c(),Document:o()},userland:n})},48141:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return o}});let n=i(50167),r=i(20997),a=n._(i(16689)),l=i(45782);async function s(e){let{Component:t,ctx:i}=e;return{pageProps:await (0,l.loadGetInitialProps)(t,i)}}class o extends a.default.Component{render(){let{Component:e,pageProps:t}=this.props;return(0,r.jsx)(e,{...t})}}o.origGetInitialProps=s,o.getInitialProps=s,("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},35244:(e,t)=>{var i;Object.defineProperty(t,"x",{enumerable:!0,get:function(){return i}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(i||(i={}))},62785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},16689:e=>{e.exports=require("react")},20997:e=>{e.exports=require("react/jsx-runtime")},55315:e=>{e.exports=require("path")}};var t=require("../../webpack-runtime.js");t.C(e);var i=e=>t(t.s=e),n=t.X(0,[1682],()=>i(52e3));module.exports=n})();