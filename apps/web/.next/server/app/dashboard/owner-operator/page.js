(()=>{var e={};e.id=2497,e.ids=[2497],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},32615:e=>{"use strict";e.exports=require("http")},35240:e=>{"use strict";e.exports=require("https")},68621:e=>{"use strict";e.exports=require("punycode")},76162:e=>{"use strict";e.exports=require("stream")},17360:e=>{"use strict";e.exports=require("url")},71568:e=>{"use strict";e.exports=require("zlib")},65456:(e,r,t)=>{"use strict";t.r(r),t.d(r,{GlobalError:()=>o.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>c,routeModule:()=>x,tree:()=>d}),t(25434),t(29089),t(32029),t(11930),t(12523);var s=t(23191),a=t(88716),n=t(37922),o=t.n(n),l=t(95231),i={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(i[e]=()=>l[e]);t.d(r,i);let d=["",{children:["dashboard",{children:["owner-operator",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,25434)),"C:\\Users\\moise\\IdeaProjects\\truckercore1\\apps\\web\\src\\app\\dashboard\\owner-operator\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,29089)),"C:\\Users\\moise\\IdeaProjects\\truckercore1\\apps\\web\\src\\app\\dashboard\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,32029)),"C:\\Users\\moise\\IdeaProjects\\truckercore1\\apps\\web\\src\\app\\layout.tsx"],loading:[()=>Promise.resolve().then(t.bind(t,11930)),"C:\\Users\\moise\\IdeaProjects\\truckercore1\\apps\\web\\src\\app\\loading.tsx"],"not-found":[()=>Promise.resolve().then(t.bind(t,12523)),"C:\\Users\\moise\\IdeaProjects\\truckercore1\\apps\\web\\src\\app\\not-found.tsx"]}],c=["C:\\Users\\moise\\IdeaProjects\\truckercore1\\apps\\web\\src\\app\\dashboard\\owner-operator\\page.tsx"],u="/dashboard/owner-operator/page",p={require:t,loadChunk:()=>Promise.resolve()},x=new s.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/dashboard/owner-operator/page",pathname:"/dashboard/owner-operator",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},14811:(e,r,t)=>{Promise.resolve().then(t.t.bind(t,12994,23)),Promise.resolve().then(t.t.bind(t,96114,23)),Promise.resolve().then(t.t.bind(t,9727,23)),Promise.resolve().then(t.t.bind(t,79671,23)),Promise.resolve().then(t.t.bind(t,41868,23)),Promise.resolve().then(t.t.bind(t,84759,23))},22462:(e,r,t)=>{Promise.resolve().then(t.t.bind(t,79404,23))},24510:(e,r,t)=>{Promise.resolve().then(t.bind(t,51271))},44697:(e,r,t)=>{Promise.resolve().then(t.bind(t,7164))},35303:()=>{},51271:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>w});var s=t(10326),a=t(17577),n=t(44976),o=t(48083),l=t(28468),i=t(57608);function d(e,r,t){return{status:r??("number"==typeof e?.status?e.status:500),code:e?.code,message:e?.message??"Unexpected error",requestId:t}}function c(e){let r="https://dummy.supabase.co",t="dummy_key_here_for_build";return r&&t?{client:(0,i.eI)(r,t,{global:{headers:{"x-request-id":e}}})}:{error:{status:500,code:"env_missing",message:"Supabase env not set",requestId:e}}}async function u(e){let r=crypto.randomUUID();try{let{client:t,error:s}=c(r);if(s)return{data:null,error:s,requestId:r};let a=t.from("ownerop_expenses").select("id,driver_id,load_id,category,amount_usd,miles,occurred_at,note").eq("driver_id",e.driverId).order("occurred_at",{ascending:!1});e.from&&(a=a.gte("occurred_at",e.from)),e.to&&(a=a.lte("occurred_at",e.to));let{data:n,error:o,status:l}=await a;if(o)return{data:null,error:d(o,l,r),requestId:r};return{data:n??[],error:null,requestId:r}}catch(e){return{data:null,error:d(e,500,r),requestId:r}}}async function p(e){let r=crypto.randomUUID();try{let{client:t,error:s}=c(r);if(s)return{data:null,error:s,requestId:r};let{data:a,error:n,status:o}=await t.from("ownerop_expenses").insert(e).select("id,driver_id,load_id,category,amount_usd,miles,occurred_at,note").single();if(n||!a)return{data:null,error:d(n,o,r),requestId:r};return{data:a,error:null,requestId:r}}catch(e){return{data:null,error:d(e,500,r),requestId:r}}}async function x(e,r){let t=crypto.randomUUID();try{let{client:s,error:a}=c(t);if(a)return{data:null,error:a,requestId:t};let{data:n,error:o,status:l}=await s.from("ownerop_expenses").update(r).eq("id",e).select("id,driver_id,load_id,category,amount_usd,miles,occurred_at,note").single();if(o||!n)return{data:null,error:d(o,l,t),requestId:t};return{data:n,error:null,requestId:t}}catch(e){return{data:null,error:d(e,500,t),requestId:t}}}async function m(e){let r=crypto.randomUUID();try{let{client:t,error:s}=c(r);if(s)return{data:null,error:s,requestId:r};let{error:a,status:n}=await t.from("ownerop_expenses").delete().eq("id",e);if(a)return{data:null,error:d(a,n,r),requestId:r};return{data:{id:e},error:null,requestId:r}}catch(e){return{data:null,error:d(e,500,r),requestId:r}}}function h(e){let r=e.reduce((e,r)=>e+(r.amount_usd??0),0),t=e.reduce((e,r)=>e+(r.miles??0),0);return{total:r,miles:t,costPerMile:t>0?r/t:0}}function g(){window.print()}function f(){return"demo-driver"}function b(){let e=f(),r=(0,n.NL)(),[t,i]=(0,a.useState)({}),{data:d,isLoading:c,error:b}=(0,o.a)({queryKey:["ownerop","expenses",e,t],queryFn:()=>u({driverId:e,from:t.from,to:t.to}).then(e=>e.data??[])}),j=(0,l.D)({mutationFn:e=>p(e).then(e=>e.data),onMutate:async s=>{await r.cancelQueries({queryKey:["ownerop","expenses",e]});let a=r.getQueryData(["ownerop","expenses",e,t])||[],n={...s,id:"tmp-"+Math.random().toString(36).slice(2)};return r.setQueryData(["ownerop","expenses",e,t],[n,...a]),{prev:a}},onError:(s,a,n)=>{n?.prev&&r.setQueryData(["ownerop","expenses",e,t],n.prev)},onSettled:()=>{r.invalidateQueries({queryKey:["ownerop","expenses",e]})}});(0,l.D)({mutationFn:({id:e,patch:r})=>x(e,r).then(e=>e.data),onMutate:async({id:s,patch:a})=>{await r.cancelQueries({queryKey:["ownerop","expenses",e]});let n=r.getQueryData(["ownerop","expenses",e,t])||[];return r.setQueryData(["ownerop","expenses",e,t],n.map(e=>e.id===s?{...e,...a}:e)),{prev:n}},onError:(s,a,n)=>{n?.prev&&r.setQueryData(["ownerop","expenses",e,t],n.prev)},onSettled:()=>{r.invalidateQueries({queryKey:["ownerop","expenses",e]})}});let v=(0,l.D)({mutationFn:e=>m(e).then(()=>e),onMutate:async s=>{await r.cancelQueries({queryKey:["ownerop","expenses",e]});let a=r.getQueryData(["ownerop","expenses",e,t])||[];return r.setQueryData(["ownerop","expenses",e,t],a.filter(e=>e.id!==s)),{prev:a}},onError:(s,a,n)=>{n?.prev&&r.setQueryData(["ownerop","expenses",e,t],n.prev)},onSettled:()=>{r.invalidateQueries({queryKey:["ownerop","expenses",e]})}}),w=(0,a.useMemo)(()=>h(d??[]),[d]);return(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"date",className:"border rounded p-1",value:t.from??"",onChange:e=>i(r=>({...r,from:e.target.value||void 0}))}),s.jsx("input",{type:"date",className:"border rounded p-1",value:t.to??"",onChange:e=>i(r=>({...r,to:e.target.value||void 0}))}),s.jsx("button",{className:"ml-auto px-3 py-1 rounded border",onClick:function(){!function(e,r,t="text/csv;charset=utf-8;"){let s=new Blob([e],{type:t}),a=URL.createObjectURL(s),n=document.createElement("a");n.href=a,n.download=r,n.click(),URL.revokeObjectURL(a)}(function(e,r){if(!e.length)return"";let t=r??Object.keys(e[0]),s=e=>{if(null==e)return"";let r=String(e);return r.includes(",")||r.includes('"')||r.includes("\n")?'"'+r.replace(/"/g,'""')+'"':r},a=[t.join(",")];for(let r of e)a.push(t.map(e=>s(r[e])).join(","));return a.join("\n")}((d??[]).map(e=>({date:e.occurred_at??"",category:e.category,amount_usd:e.amount_usd,miles:e.miles??"",load_id:e.load_id??"",note:e.note??""})),["date","category","amount_usd","miles","load_id","note"]),"expenses.csv")},children:"Export CSV"}),s.jsx("button",{className:"px-3 py-1 rounded border",onClick:g,children:"Print / PDF"})]}),s.jsx(y,{onAdd:e=>j.mutate(e)}),s.jsx("div",{className:"rounded border",children:c?s.jsx("div",{className:"p-4",children:"Loadingâ€¦"}):b?s.jsx("div",{className:"p-4 text-red-600",children:"Error loading expenses"}):(0,s.jsxs)("table",{className:"w-full text-sm",children:[s.jsx("thead",{children:(0,s.jsxs)("tr",{className:"bg-gray-50 text-left",children:[s.jsx("th",{className:"p-2",children:"Date"}),s.jsx("th",{className:"p-2",children:"Category"}),s.jsx("th",{className:"p-2 text-right",children:"Amount"}),s.jsx("th",{className:"p-2 text-right",children:"Miles"}),s.jsx("th",{className:"p-2",children:"Load"}),s.jsx("th",{className:"p-2",children:"Note"}),s.jsx("th",{className:"p-2"})]})}),s.jsx("tbody",{children:(d??[]).map(e=>(0,s.jsxs)("tr",{className:"border-t",children:[s.jsx("td",{className:"p-2",children:e.occurred_at?new Date(e.occurred_at).toLocaleDateString():""}),s.jsx("td",{className:"p-2",children:e.category}),(0,s.jsxs)("td",{className:"p-2 text-right",children:["$","{","r.amount_usd.toFixed(2)","}"]}),s.jsx("td",{className:"p-2 text-right",children:e.miles??""}),s.jsx("td",{className:"p-2",children:e.load_id??""}),s.jsx("td",{className:"p-2",children:e.note??""}),s.jsx("td",{className:"p-2 text-right",children:s.jsx("button",{className:"text-red-600 text-xs",onClick:()=>v.mutate(e.id),children:"Delete"})})]},e.id))})]})}),(0,s.jsxs)("div",{className:"rounded border p-3 bg-white",children:[s.jsx("div",{className:"font-medium mb-1",children:"Totals"}),(0,s.jsxs)("div",{className:"text-sm text-gray-700",children:["Total: $","{","summary.total.toFixed(2)","}"," \xb7 Miles: ",w.miles," \xb7 Cost/Mile: $","{","summary.costPerMile.toFixed(2)","}"]})]})]})}function y({onAdd:e}){let r=f(),[t,n]=(0,a.useState)({driver_id:r,category:"fuel",amount_usd:0,miles:null,load_id:null,occurred_at:new Date().toISOString().slice(0,10),note:""});return(0,s.jsxs)("form",{className:"flex flex-wrap items-end gap-2 bg-white rounded border p-3",onSubmit:r=>{r.preventDefault(),e(t)},children:[(0,s.jsxs)("label",{className:"text-sm",children:["Date",s.jsx("input",{type:"date",className:"block border rounded p-1",value:t.occurred_at?.slice(0,10)??"",onChange:e=>n(r=>({...r,occurred_at:e.target.value}))})]}),(0,s.jsxs)("label",{className:"text-sm",children:["Category",(0,s.jsxs)("select",{className:"block border rounded p-1",value:t.category,onChange:e=>n(r=>({...r,category:e.target.value})),children:[s.jsx("option",{value:"fuel",children:"Fuel"}),s.jsx("option",{value:"toll",children:"Tolls"}),s.jsx("option",{value:"repair",children:"Repairs"}),s.jsx("option",{value:"insurance",children:"Insurance"}),s.jsx("option",{value:"other",children:"Other"})]})]}),(0,s.jsxs)("label",{className:"text-sm",children:["Amount (USD)",s.jsx("input",{type:"number",step:"0.01",className:"block border rounded p-1",value:t.amount_usd,onChange:e=>n(r=>({...r,amount_usd:Number(e.target.value)}))})]}),(0,s.jsxs)("label",{className:"text-sm",children:["Miles",s.jsx("input",{type:"number",className:"block border rounded p-1",value:t.miles??"",onChange:e=>n(r=>({...r,miles:e.target.value?Number(e.target.value):null}))})]}),(0,s.jsxs)("label",{className:"text-sm",children:["Load ID",s.jsx("input",{type:"text",className:"block border rounded p-1",value:t.load_id??"",onChange:e=>n(r=>({...r,load_id:e.target.value||null}))})]}),(0,s.jsxs)("label",{className:"text-sm grow",children:["Note",s.jsx("input",{type:"text",className:"block border rounded p-1 w-full",value:t.note??"",onChange:e=>n(r=>({...r,note:e.target.value}))})]}),s.jsx("button",{type:"submit",className:"px-3 py-1 rounded bg-blue-600 text-white",children:"Add"})]})}function j(){let e="demo-driver",{data:r}=(0,o.a)({queryKey:["ownerop","expenses",e],queryFn:()=>u({driverId:e}).then(e=>e.data??[])}),t=h(r??[]),a=(t.miles,null);return(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[s.jsx(v,{title:"Gross Revenue",value:"â€”"}),s.jsx(v,{title:"Total Costs",value:`$${t.total.toFixed(2)}`}),s.jsx(v,{title:"Net Profit",value:"â€”"}),s.jsx(v,{title:"Miles",value:String(t.miles)}),s.jsx(v,{title:"Cost / Mile",value:`$${t.costPerMile.toFixed(2)}`}),s.jsx(v,{title:"PPM (Revenue/Mile)",value:null!=a?`$${a.toFixed(2)}`:"â€”"})]})}function v({title:e,value:r}){return(0,s.jsxs)("div",{className:"rounded border bg-white p-3",children:[s.jsx("div",{className:"text-xs text-gray-600",children:e}),s.jsx("div",{className:"text-lg font-semibold",children:r})]})}function w(){return(0,s.jsxs)("div",{className:"p-4 space-y-4",children:[s.jsx("h1",{className:"text-xl font-semibold",children:"Owner-Operator"}),s.jsx(_,{})]})}function _(){let[e,r]=(0,a.useState)("expenses");return(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"flex gap-2",children:[s.jsx("button",{className:`px-3 py-1 rounded border ${"expenses"===e?"bg-blue-600 text-white":""}`,onClick:()=>r("expenses"),children:"My Expenses"}),s.jsx("button",{className:`px-3 py-1 rounded border ${"profit"===e?"bg-blue-600 text-white":""}`,onClick:()=>r("profit"),children:"Profitability"})]}),s.jsx("div",{children:s.jsx(a.Suspense,{fallback:s.jsx("div",{className:"p-4",children:"Loadingâ€¦"}),children:"expenses"===e?s.jsx(b,{}):s.jsx(j,{})})})]})}},7164:(e,r,t)=>{"use strict";t.d(r,{FeatureFlagsProvider:()=>o,g:()=>l});var s=t(10326),a=t(17577);let n=(0,a.createContext)({});function o({children:e,initialFlags:r={}}){let[t]=(0,a.useState)(r);return s.jsx(n.Provider,{value:t,children:e})}function l(){return(0,a.useContext)(n)}},29089:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>l});var s=t(19510),a=t(68570);let n=(0,a.createProxy)(String.raw`C:\Users\moise\IdeaProjects\truckercore1\apps\web\src\lib\featureFlags.tsx#FeatureFlagsProvider`);(0,a.createProxy)(String.raw`C:\Users\moise\IdeaProjects\truckercore1\apps\web\src\lib\featureFlags.tsx#useFeatureFlags`);var o=t(94738);async function l({children:e}){let r={},t="https://dummy.supabase.co",a="dummy_key_here_for_build";if(t&&a)try{let e=(0,o.eI)(t,a),{data:s,error:n}=await e.from("feature_flags").select("key, enabled");!n&&s&&(r=s.reduce((e,r)=>(r?.key&&(e[r.key]=!!r.enabled),e),{}))}catch(e){}return s.jsx(n,{initialFlags:r,children:(0,s.jsxs)("div",{className:"grid gap-4",children:[s.jsx("div",{className:"text-sm text-gray-700",children:"Dashboard"}),e]})})}},25434:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>s});let s=(0,t(68570).createProxy)(String.raw`C:\Users\moise\IdeaProjects\truckercore1\apps\web\src\app\dashboard\owner-operator\page.tsx#default`)},32029:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>n,metadata:()=>a});var s=t(19510);let a={title:"TruckerCore",description:"Trucking Management System"};function n({children:e}){return s.jsx("html",{lang:"en",children:s.jsx("body",{children:e})})}},11930:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>a});var s=t(19510);function a(){return(0,s.jsxs)("div",{style:n.container,children:[s.jsx("div",{style:n.spinner}),s.jsx("p",{style:n.text,children:"Loading..."})]})}let n={container:{minHeight:"100vh",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",backgroundColor:"#0F1216",color:"#ffffff"},spinner:{width:"48px",height:"48px",border:"4px solid #2A313A",borderTop:"4px solid #58A6FF",borderRadius:"50%",animation:"spin 1s linear infinite"},text:{marginTop:"16px",fontSize:"16px",color:"#8B949E"}}},12523:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>n});var s=t(19510),a=t(57371);function n(){return(0,s.jsxs)("div",{style:o.container,children:[s.jsx("h1",{style:o.title,children:"404"}),s.jsx("h2",{style:o.subtitle,children:"Page Not Found"}),s.jsx("p",{style:o.description,children:"The page you're looking for doesn't exist or has been moved."}),(0,s.jsxs)("div",{style:o.links,children:[s.jsx(a.default,{href:"/",style:o.primaryLink,children:"Go Home"}),s.jsx(a.default,{href:"https://app.truckercore.com",style:o.secondaryLink,children:"Launch App"})]})]})}let o={container:{minHeight:"100vh",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"24px",backgroundColor:"#0F1216",color:"#ffffff",textAlign:"center"},title:{fontSize:"96px",fontWeight:700,background:"linear-gradient(135deg, #58A6FF 0%, #79C0FF 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text",marginBottom:"16px"},subtitle:{fontSize:"32px",fontWeight:600,marginBottom:"16px",color:"#ffffff"},description:{fontSize:"18px",color:"#8B949E",marginBottom:"32px",maxWidth:"500px"},links:{display:"flex",gap:"16px",flexWrap:"wrap",justifyContent:"center"},primaryLink:{padding:"14px 32px",backgroundColor:"#58A6FF",color:"#000",borderRadius:"8px",fontWeight:600,fontSize:"16px",transition:"all 0.2s"},secondaryLink:{padding:"14px 32px",border:"2px solid #58A6FF",color:"#58A6FF",borderRadius:"8px",fontWeight:600,fontSize:"16px",transition:"all 0.2s"}}}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[8948,6779,4738,7608,3193],()=>t(65456));module.exports=s})();