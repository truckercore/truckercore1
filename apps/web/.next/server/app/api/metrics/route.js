"use strict";(()=>{var e={};e.id=2996,e.ids=[2996],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},89798:e=>{e.exports=require("cluster")},92048:e=>{e.exports=require("fs")},32615:e=>{e.exports=require("http")},35240:e=>{e.exports=require("https")},96119:e=>{e.exports=require("perf_hooks")},35816:e=>{e.exports=require("process")},17360:e=>{e.exports=require("url")},21764:e=>{e.exports=require("util")},99672:e=>{e.exports=require("v8")},71568:e=>{e.exports=require("zlib")},82162:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>d,patchFetch:()=>m,requestAsyncStorage:()=>l,routeModule:()=>c,serverHooks:()=>E,staticGenerationAsyncStorage:()=>C});var _={};r.r(_),r.d(_,{GET:()=>T,POST:()=>p});var s=r(49303),o=r(88716),a=r(60670),n=r(87070),i=r(92849);let u=process.env.SUPABASE_SERVICE_ROLE_KEY;async function T(){let e=await i.z2.metrics();return new n.NextResponse(e,{status:200,headers:{"Content-Type":i.z2.contentType}})}async function p(e){try{let{kind:t,value:r=1,labels:_={},props:s={}}=await e.json()||{};if(!t)return n.NextResponse.json({error:"kind required"},{status:400});let o=await fetch("https://dummy.supabase.co/rest/v1/metrics_events",{method:"POST",headers:{apikey:u,Authorization:`Bearer ${u}`,"Content-Type":"application/json",Prefer:"return=minimal"},body:JSON.stringify({kind:t,value:r,labels:_,props:s})});try{i.hW.inc({kind:t})}catch{}if(!o.ok)return n.NextResponse.json({error:"failed to write metric"},{status:500});return n.NextResponse.json({ok:!0},{status:200})}catch(e){return n.NextResponse.json({error:e?.message||"Server error"},{status:500})}}let c=new s.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/metrics/route",pathname:"/api/metrics",filename:"route",bundlePath:"app/api/metrics/route"},resolvedPagePath:"C:\\Users\\moise\\IdeaProjects\\truckercore1\\apps\\web\\src\\app\\api\\metrics\\route.ts",nextConfigOutput:"standalone",userland:_}),{requestAsyncStorage:l,staticGenerationAsyncStorage:C,serverHooks:E}=c,d="/api/metrics/route";function m(){return(0,a.patchFetch)({serverHooks:E,staticGenerationAsyncStorage:C})}},92849:(e,t,r)=>{r.d(t,{aK:()=>i,hW:()=>p,q2:()=>a,z2:()=>o});var _=r(92111);let s=globalThis;s.__TC_METRICS_REG__||(s.__TC_METRICS_REG__=new _.Registry);let o=s.__TC_METRICS_REG__;s.__TC_COLLECTED_DEFAULTS__||((0,_.collectDefaultMetrics)({prefix:"truckercore_",register:o}),s.__TC_COLLECTED_DEFAULTS__=!0);let a=s.__TC_EXPORT_COUNTER__||new _.Counter({name:"truckercore_exports_total",help:"Total CSV/PDF exports",labelNames:["kind","org_id"],registers:[o]});s.__TC_EXPORT_COUNTER__||(s.__TC_EXPORT_COUNTER__=a);let n=s.__TC_CHECKOUT_COUNTER__||new _.Counter({name:"truckercore_checkouts_total",help:"Total Stripe checkouts initiated",labelNames:["plan"],registers:[o]});s.__TC_CHECKOUT_COUNTER__||(s.__TC_CHECKOUT_COUNTER__=n);let i=s.__TC_API_LATENCY__||new _.Histogram({name:"truckercore_api_latency_seconds",help:"API endpoint latency",labelNames:["route"],buckets:[.1,.5,1,2,5],registers:[o]});s.__TC_API_LATENCY__||(s.__TC_API_LATENCY__=i);let u=s.__TC_HTTP_REQ_TOTAL__||new _.Counter({name:"truckercore_http_requests_total",help:"Total HTTP requests",labelNames:["method","route","status"],registers:[o]});s.__TC_HTTP_REQ_TOTAL__||(s.__TC_HTTP_REQ_TOTAL__=u);let T=s.__TC_HTTP_REQ_DUR__||new _.Histogram({name:"truckercore_http_request_duration_seconds",help:"HTTP request duration in seconds",labelNames:["method","route","status"],buckets:[.01,.05,.1,.5,1,2,5],registers:[o]});s.__TC_HTTP_REQ_DUR__||(s.__TC_HTTP_REQ_DUR__=T);let p=s.__TC_CUSTOM_EVENTS__||new _.Counter({name:"truckercore_custom_events_total",help:"Total custom events logged",labelNames:["kind"],registers:[o]});s.__TC_CUSTOM_EVENTS__||(s.__TC_CUSTOM_EVENTS__=p)}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),_=t.X(0,[8948,5972,2111],()=>r(82162));module.exports=_})();